/*! For license information please see 66.js.LICENSE.txt */
exports.id=66,exports.ids=[66],exports.modules={12082:t=>{class e{constructor(t){this._buffer=t}open(){return Promise.resolve()}close(){return Promise.resolve()}read(t,e,s,i){return this._buffer.copy(t,e,i,i+s),Promise.resolve(t)}buffer(){return this._buffer}static isBufferReader(t){return t instanceof e}}t.exports=e},22122:(t,e,s)=>{const i=s(32235);class r{constructor(t,e){this._doc=t,this._dirEntry=e}storage(t){return new r(this._doc,this._dirEntry.storages[t])}stream(t){return new i(this._doc,this._dirEntry.streams[t])}}t.exports=r},31487:(t,e)=>{"use strict";function s(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="\t\n\r -퟿-�𐀀-􏿿",e.S=" \t\r\n",e.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.CHAR_RE=new RegExp("^["+e.CHAR+"]$","u"),e.S_RE=new RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=new RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=new RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=new RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=new RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(t){return t>=32&&t<=55295||10===t||13===t||9===t||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isS=function(t){return 32===t||10===t||13===t||9===t},e.isNameStartChar=s,e.isNameChar=function(t){return s(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},31682:(t,e,s)=>{const i=s(16928),r=s(38223),n=s(84824),o=s(12082),a=s(44762),h=s(33951);function c(t,e,s){return s===e.length?Promise.resolve():Promise.resolve(t(e[s++])).then((()=>c(t,e,s)))}t.exports=class{constructor(){this._streamTypes={"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":!0,"application/vnd.openxmlformats-package.relationships+xml":!0},this._headerTypes={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":!0,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":!0},this._actions={},this._defaults={}}shouldProcess(t){if(this._actions[t])return!0;const e=i.posix.extname(t).replace(/^\./,"");if(!e)return!1;const s=this._defaults[e];return!(!s||!this._streamTypes[s])}openArchive(t){if(o.isBufferReader(t))return new Promise(((e,s)=>{n.fromBuffer(t.buffer(),{lazyEntries:!0},(function(t,i){if(t)return s(t);e(i)}))}));if(a.isFileReader(t))return new Promise(((e,s)=>{n.fromFd(t.fd(),{lazyEntries:!0,autoClose:!1},(function(t,i){if(t)return s(t);e(i)}))}));throw new Error("Unexpected reader type: "+t.constructor.name)}processEntries(t){let e={},s=[];return new Promise(((i,r)=>{t.readEntry(),t.on("error",r),t.on("entry",(i=>{const r=i.fileName;e[r]=i,s.push(r),t.readEntry()})),t.on("end",(()=>i(this._document)))})).then((()=>{const i=s.indexOf("[Content_Types].xml");if(-1===i)throw new Error("Invalid Open Office XML: missing content types");return s.splice(i,1),s.unshift("[Content_Types].xml"),this._actions["[Content_Types].xml"]=!0,c((s=>{if(this.shouldProcess(s))return this.handleEntry(t,e[s])}),s,0)}))}extract(t){let e=this.openArchive(t);return this._document=new h,this._relationships={},this._entryTable={},this._entries=[],e.then((t=>this.processEntries(t))).then((()=>{let t=this._document;return t._textboxes&&t._textboxes.length>0&&(t._textboxes=t._textboxes+"\n"),t._headerTextboxes&&t._headerTextboxes.length>0&&(t._headerTextboxes=t._headerTextboxes+"\n"),t}))}handleOpenTag(t){if("Override"===t.name){const e=this._streamTypes[t.attributes.ContentType];if(e){const s=t.attributes.PartName.replace(/^[/]+/,""),i={action:e,type:t.attributes.ContentType};this._actions[s]=i}}else if("Default"===t.name){const e=t.attributes.Extension,s=t.attributes.ContentType;this._defaults[e]=s}else if("Relationship"===t.name)this._relationships[t.attributes.Id]={type:t.attributes.Type,target:t.attributes.Target};else if("w:document"===t.name||"w:footnotes"===t.name||"w:endnotes"===t.name||"w:comments"===t.name)this._context=["content","body"],this._pieces=[];else if("w:hdr"===t.name||"w:ftr"===t.name)this._context=["content","header"],this._pieces=[];else if("w:endnote"===t.name||"w:footnote"===t.name){const e=t.attributes["w:type"]||this._context[0];this._context.unshift(e)}else"w:tab"===t.name&&"content"===this._context[0]?this._pieces.push("\t"):"w:br"===t.name&&"content"===this._context[0]?(t.attributes["w:type"],this._pieces.push("\n")):"w:del"===t.name||"w:instrText"===t.name?this._context.unshift("deleted"):"w:tabs"===t.name?this._context.unshift("tabs"):"w:tc"===t.name?this._context.unshift("cell"):"w:drawing"===t.name?this._context.unshift("drawing"):"w:txbxContent"===t.name&&(this._context.unshift(this._pieces),this._context.unshift("textbox"),this._pieces=[])}handleCloseTag(t){if("w:document"===t.name)this._context=null,this._document._body=this._pieces.join("");else if("w:footnote"===t.name||"w:endnote"===t.name)this._context.shift();else if("w:footnotes"===t.name)this._context=null,this._document._footnotes=this._pieces.join("");else if("w:endnotes"===t.name)this._context=null,this._document._endnotes=this._pieces.join("");else if("w:comments"===t.name)this._context=null,this._document._annotations=this._pieces.join("");else if("w:hdr"===t.name)this._context=null,this._document._headers=this._document._headers+this._pieces.join("");else if("w:ftr"===t.name)this._context=null,this._document._footers=this._document._footers+this._pieces.join("");else if("w:p"===t.name)"content"!==this._context[0]&&"cell"!==this._context[0]&&"textbox"!==this._context[0]||this._pieces.push("\n");else if("w:del"===t.name||"w:instrText"===t.name)this._context.shift();else if("w:tabs"===t.name)this._context.shift();else if("w:tc"===t.name)this._pieces.pop(),this._pieces.push("\t"),this._context.shift();else if("w:tr"===t.name)this._pieces.push("\n");else if("w:drawing"===t.name)this._context.shift();else if("w:txbxContent"===t.name){const t=this._pieces.join("");if("textbox"!==this._context.shift())throw new Error("Invalid textbox context");if(this._pieces=this._context.shift(),"drawing"===this._context[0])return;if(0==t.length)return;const e=this._context.includes("header")?"_headerTextboxes":"_textboxes";this._document[e]?this._document[e]=this._document[e]+"\n"+t:this._document[e]=t}}createXmlParser(){const t=new r.SaxesParser;return t.on("opentag",(e=>{try{this.handleOpenTag(e)}catch(e){t.fail(e.message)}})),t.on("closetag",(e=>{try{this.handleCloseTag(e)}catch(e){t.fail(e.message)}})),t.on("text",(e=>{try{if(!this._context)return;"content"!==this._context[0]&&"cell"!==this._context[0]&&"textbox"!==this._context[0]||this._pieces.push(e)}catch(e){t.fail(e.message)}})),t}handleEntry(t,e){return new Promise(((s,i)=>{t.openReadStream(e,((t,r)=>{if(t)return i(t);this._source=e.fileName;const n=this.createXmlParser();n.on("error",(t=>{r.destroy(t),i(t)})),n.on("end",(()=>s())),r.on("end",(()=>n.close())),r.on("error",(t=>i(t))),r.on("readable",(()=>{for(;;){const t=r.read(4096);if(null===t)return;n.write(t)}}))}))}))}}},32235:(t,e,s)=>{const{Readable:i}=s(2203);t.exports=class extends i{constructor(t,e){super(),this._doc=t,this._streamEntry=e,this.initialize()}initialize(){if(this._index=0,this._done=!0,!this._streamEntry)return;const t=this._doc;this._bytes=this._streamEntry.size,this._allocationTable=t._SAT,this._shortStream=!1,this._bytes<t._header.shortStreamMax&&(this._shortStream=!0,this._allocationTable=t._SSAT),this._secIds=this._allocationTable.getSecIdChain(this._streamEntry.secId),this._done=!1}_readSector(t){return this._shortStream?this._doc._readShortSector(t):this._doc._readSector(t)}_read(){return this._done?this.push(null):this._index>=this._secIds.length?(this._done=!0,this.push(null)):this._readSector(this._secIds[this._index]).then((t=>{this._bytes-t.length<0&&(t=t.slice(0,this._bytes)),this._bytes-=t.length,this._index++,this.push(t)}))}}},32484:(t,e,s)=>{const i=s(42249),r=s(33951),{binaryToUnicode:n,clean:o}=s(82327),a=(t,e)=>{for(let s=0;s<t.length;s++)if(e<=t[s].endCp)return s},h=(t,e)=>{for(let s=0;s<t.length;s++)if(e<=t[s].endFilePos)return s};function c(t,e,s){const i=a(t,e),r=a(t,s),n=[];for(let o=i,a=r;o<=a;o++){const a=t[o],h=o===i?e-a.startCp:0,c=o===r?s-a.startCp:a.endCp;n.push(a.text.substring(h,c))}return n.join("")}function l(t,e,s,i){const r=t.startCp,n=r+t.length,o=t.text;e<r&&(e=r),s>n&&(s=n);const a=(e==r?"":o.slice(0,e-r))+"".padStart(s-e,i)+(s==n?"":o.slice(s-n));t.text=a}function d(t,e,s,i){const r=t.startFilePos,n=r+t.size,o=t.text;e<r&&(e=r),s>n&&(s=n);const a=(e==r?"":o.slice(0,(e-r)/t.bpc))+"".padStart((s-e)/t.bpc,i)+(s==n?"":o.slice((s-n)/t.bpc));t.text=a}function u(t,e,s,i){for(let r=a(t,e),n=a(t,s);r<=n;r++)l(t[r],e,s,i)}function f(t,e,s,i){for(let r=h(t,e),n=h(t,s);r<=n;r++)d(t[r],e,s,i)}function p(t,e,s){f(t,e,s,"\0")}const m=(t,e,s)=>{for(;e<t.length-1;){const i=t.readUInt16LE(e),r=i>>13&7;if(s(t,e+=2,i,31&i,i>>9&1,i>>10&7,r),0!==r)if(1!==r)if(2!==r)if(3!==r)if(4!==r&&5!==r)if(6!==r){if(7!==r)throw new Error("Unparsed sprm");e+=3}else e+=t.readUInt8(e)+1;else e+=2;else e+=4;else e+=2;else e+=1;else e+=1}};t.exports=class{constructor(){this._pieces=[],this._bookmarks={},this._boundaries={},this._taggedHeaders=[]}extract(t){const e=new i(t);return e.read().then((()=>this.documentStream(e,"WordDocument").then((t=>this.streamBuffer(t))).then((t=>this.extractWordDocument(e,t)))))}buildDocument(){const t=new r,e=this._pieces;let s=0;return t._body=o(c(e,s,s+this._boundaries.ccpText)),s+=this._boundaries.ccpText,this._boundaries.ccpFtn&&(t._footnotes=o(c(e,s,s+this._boundaries.ccpFtn-1)),s+=this._boundaries.ccpFtn),this._boundaries.ccpHdd&&(t._headers=o(this._taggedHeaders.filter((t=>"headers"===t.type)).map((t=>t.text)).join("")),t._footers=o(this._taggedHeaders.filter((t=>"footers"===t.type)).map((t=>t.text)).join("")),s+=this._boundaries.ccpHdd),this._boundaries.ccpAtn&&(t._annotations=o(c(e,s,s+this._boundaries.ccpAtn-1)),s+=this._boundaries.ccpAtn),this._boundaries.ccpEdn&&(t._endnotes=o(c(e,s,s+this._boundaries.ccpEdn-1)),s+=this._boundaries.ccpEdn),this._boundaries.ccpTxbx&&(t._textboxes=o(c(e,s,s+this._boundaries.ccpTxbx-1)),s+=this._boundaries.ccpTxbx),this._boundaries.ccpHdrTxbx&&(t._headerTextboxes=o(c(e,s,s+this._boundaries.ccpHdrTxbx-1)),s+=this._boundaries.ccpHdrTxbx),t}extractWordDocument(t,e){const s=e.readUInt16LE(0);if(42476!==s)return Promise.reject(new Error(`This does not seem to be a Word document: Invalid magic number: ${s.toString(16)}`));const i=512&e.readUInt16LE(10)?"1Table":"0Table";return this.documentStream(t,i).then((t=>this.streamBuffer(t))).then((t=>(this._boundaries.fcMin=e.readUInt32LE(24),this._boundaries.ccpText=e.readUInt32LE(76),this._boundaries.ccpFtn=e.readUInt32LE(80),this._boundaries.ccpHdd=e.readUInt32LE(84),this._boundaries.ccpAtn=e.readUInt32LE(92),this._boundaries.ccpEdn=e.readUInt32LE(96),this._boundaries.ccpTxbx=e.readUInt32LE(100),this._boundaries.ccpHdrTxbx=e.readUInt32LE(104),this.writeBookmarks(e,t),this.writePieces(e,t),this.writeCharacterProperties(e,t),this.writeParagraphProperties(e,t),this.normalizeHeaders(e,t),this.buildDocument())))}documentStream(t,e){return Promise.resolve(t.stream(e))}streamBuffer(t){return new Promise(((e,s)=>{const i=[];return t.on("data",(t=>i.push(t))),t.on("error",(t=>s(t))),t.on("end",(()=>e(Buffer.concat(i)))),t}))}writeFields(t,e,s){const i=t.readInt32LE(282),r=t.readUInt32LE(286);if(0==r)return;const n=(r-4)/6,o=4*(n+1),a=e.slice(i,i+r);for(let t=0;t<n;t++)a.readUInt32LE(4*t),a.readUInt16LE(o+2*t)}writeBookmarks(t,e){const s=t.readUInt32LE(322),i=t.readUInt32LE(326),r=t.readUInt32LE(330),n=t.readUInt32LE(334),o=t.readUInt32LE(338),a=t.readUInt32LE(342);if(0===i)return;const h=e.slice(s,s+i),c=e.slice(r,r+n),l=e.slice(o,o+a),d=h.readUInt16LE(0);if(h.readUInt16LE(2),h.readUInt16LE(4),65535!==d)throw new Error("Internal error: unexpected single-byte bookmark data");let u=6;for(;u<i;){let t=h.readUInt16LE(u);t*=2;const e=h.slice(u+2,u+2+t),s=c.readUInt32LE(0),i=l.readUInt32LE(0);this._bookmarks[e]={start:s,end:i},u=u+t+2}}writePieces(t,e){let s,i=t.readUInt32LE(418);for(;s=e.readUInt8(i),1===s;)i+=1,i=i+2+e.readUInt16LE(i);if(s=e.readUInt8(i),i+=1,2!==s)throw new Error("Internal error: ccorrupted Word file");const r=e.readUInt32LE(i);i+=4;const o=(r-4)/12;let a=0,h=0;for(let s=0,r=o-1;s<=r;s++){const r=i+4*(o+1)+8*s+2;let c=e.readUInt32LE(r),l=!1;1073741824&c?(c&=-1073741825,c=Math.floor(c/2)):l=!0;const d=e.readUInt32LE(i+4*s),u=e.readUInt32LE(i+4*(s+1)),f={startCp:a,startStream:h,totLength:u-d,startFilePos:c,unicode:l,bpc:l?2:1};f.size=f.bpc*(u-d);const p=t.slice(c,c+f.size);f.text=l?p.toString("ucs2"):n(p.toString("binary")),f.length=f.text.length,f.endCp=f.startCp+f.length,f.endStream=f.startStream+f.size,f.endFilePos=f.startFilePos+f.size,a=f.endCp,h=f.endStream,this._pieces.push(f)}}normalizeHeaders(t,e){const s=this._pieces,i=t.readUInt32LE(242),r=t.readUInt32LE(246);if(r<8)return;const n=this._boundaries.ccpText+this._boundaries.ccpFtn,o=this._boundaries.ccpHdd,a=e.slice(i,i+r),h=r/4;let l=n+a.readUInt32LE(0);for(let t=1;t<h;t++){let e=n+a.readUInt32LE(4*t);e>n+o&&(e=n+o);const i=c(s,l,e),r=t-1;[0,1,2].includes(r)?this._taggedHeaders.push({type:"footnoteSeparators",text:i}):[3,4,5].includes(r)?this._taggedHeaders.push({type:"endSeparators",text:i}):[0,1,4].includes(r%6)?this._taggedHeaders.push({type:"headers",text:i}):[2,3,5].includes(r%6)&&this._taggedHeaders.push({type:"footers",text:i}),/[^\r\n\u0002-\u0008]/.test(i)?u(s,e-1,e,"\0"):u(s,l,e,"\0"),l=e}}writeParagraphProperties(t,e){const s=this._pieces,i=t.readUInt32LE(258),r=t.readUInt32LE(262),n=(r-4)/8,o=4*(n+1),a=e.slice(i,i+r);for(let e=0;e<n;e++){a.readUInt32LE(4*e);const i=a.readUInt32LE(o+4*e),r=t.slice(512*i,512*(i+1)),n=r.readUInt8(511);for(let t=0;t<n;t++){const e=r.readUInt32LE(4*t),i=r.readUInt32LE(4*(t+1)),o=4*(n+1)+13*t,a=2*r.readUInt8(o),h=r.readUInt8(a);let c=null;if(0!==h)c=r.slice(a+1,a+1+2*h-1);else{const t=r.readUInt8(a+1);c=r.slice(a+2,a+2+2*t)}c.readUInt16LE(0),m(c,2,((t,r,n,o,a,h,c)=>{9239===n&&f(s,e,i,"\n")}))}}}writeCharacterProperties(t,e){const s=this._pieces,i=t.readUInt32LE(250),r=t.readUInt32LE(254),n=(r-4)/8,o=4*(n+1),a=e.slice(i,i+r);let h=null;for(let e=0;e<n;e++){a.readUInt32LE(4*e);const i=a.readUInt32LE(o+4*e),r=t.slice(512*i,512*(i+1)),n=r.readUInt8(511);for(let t=0;t<n;t++){const e=r.readUInt32LE(4*t),i=r.readUInt32LE(4*(t+1)),o=r.readUInt8(4*(n+1)+t);if(0==o)continue;const a=2*o,c=r.readUInt8(a),l=r.slice(a+1,a+1+c);m(l,0,((t,r,n,o)=>{if(0===o){if(1&~t[r])return;p(s,h===e?h:e,i),h=i}}))}}}}},33951:(t,e,s)=>{const{filter:i}=s(82327);t.exports=class{constructor(){this._body="",this._footnotes="",this._endnotes="",this._headers="",this._footers="",this._annotations="",this._textboxes="",this._headerTextboxes=""}getBody(t){t=t||{};const e=this._body;return 0==t.filterUnicode?e:i(e)}getFootnotes(t){t=t||{};const e=this._footnotes;return 0==t.filterUnicode?e:i(e)}getEndnotes(t){t=t||{};const e=this._endnotes;return 0==t.filterUnicode?e:i(e)}getHeaders(t){t=t||{};const e=this._headers+(0==t.includeFooters?"":this._footers);return 0==t.filterUnicode?e:i(e)}getFooters(t){t=t||{};const e=this._footers;return 0==t.filterUnicode?e:i(e)}getAnnotations(t){t=t||{};const e=this._annotations;return 0==t.filterUnicode?e:i(e)}getTextboxes(t){const e=[];0!=(t=t||{}).includeBody&&e.push(this._textboxes),0!=t.includeHeadersAndFooters&&e.push(this._headerTextboxes);const s=e.join("\n");return 0==t.filterUnicode?s:i(s)}}},37136:t=>{t.exports=class{constructor(t){this._doc=t}load(t){const e=this._doc,s=e._header;return this._table=new Array(t.length*(s.secSize/4)),e._readSectors(t).then((t=>{for(let e=0;e<t.length/4;e++)this._table[e]=t.readInt32LE(4*e)}))}getSecIdChain(t){let e=t;const s=[];for(;e>-1;){s.push(e);const t=e;if(e=this._table[e],e===t)break}return s}}},38065:(t,e)=>{"use strict";function s(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.NC_NAME_START_CHAR="A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NC_NAME_CHAR="-"+e.NC_NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.NC_NAME_START_CHAR_RE=new RegExp("^["+e.NC_NAME_START_CHAR+"]$","u"),e.NC_NAME_CHAR_RE=new RegExp("^["+e.NC_NAME_CHAR+"]$","u"),e.NC_NAME_RE=new RegExp("^["+e.NC_NAME_START_CHAR+"]["+e.NC_NAME_CHAR+"]*$","u"),e.isNCNameStartChar=s,e.isNCNameChar=function(t){return s(t)||45===t||46===t||t>=48&&t<=57||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},38223:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(31487),r=s(84797),n=s(38065);var o=i.isS,a=i.isChar,h=i.isNameStartChar,c=i.isNameChar,l=i.S_LIST,d=i.NAME_RE,u=r.isChar,f=n.isNCNameStartChar,p=n.isNCNameChar,m=n.NC_NAME_RE;const _="http://www.w3.org/XML/1998/namespace",x="http://www.w3.org/2000/xmlns/",g={__proto__:null,xml:_,xmlns:x},b={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},S=-1,C=-2,E=13,T=33,w=10,A=60,I=61,v=62,y=63,R=93,N=t=>34===t||39===t,L=[34,39],k=[...L,91,v],P=[...L,A,R],D=[I,y,...l],H=[...l,v,38,A];function M(t,e,s){switch(e){case"xml":s!==_&&t.fail(`xml prefix must be bound to ${_}.`);break;case"xmlns":s!==x&&t.fail(`xmlns prefix must be bound to ${x}.`)}switch(s){case x:t.fail(""===e?`the default namespace may not be set to ${s}.`:`may not assign a prefix (even "xmlns") to the URI ${x}.`);break;case _:switch(e){case"xml":break;case"":t.fail(`the default namespace may not be set to ${s}.`);break;default:t.fail("may not assign the xml namespace to another prefix.")}}}const U=t=>m.test(t),$=t=>d.test(t);e.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const B={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};e.SaxesParser=class{constructor(t){this.opt=null!=t?t:{},this.fragmentOpt=!!this.opt.fragment;const e=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,e){this.nameStartCheck=f,this.nameCheck=p,this.isName=U,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},g);const t=this.opt.additionalNamespaces;null!=t&&(function(t,e){for(const s of Object.keys(e))M(t,s,e[s])}(this,t),Object.assign(this.ns,t))}else this.nameStartCheck=h,this.nameCheck=c,this.isName=$,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var t;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:e}=this;this.state=e?E:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=e,this.xmlDeclPossible=!e,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:s}=this.opt;if(void 0===s){if(!0===this.opt.forceXMLVersion)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");s="1.0"}this.setXMLVersion(s),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(b),null===(t=this.readyHandler)||void 0===t||t.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(t,e){this[B[t]]=e}off(t){this[B[t]]=void 0}makeError(t){var e;let s=null!==(e=this.fileName)&&void 0!==e?e:"";return this.trackPosition&&(s.length>0&&(s+=":"),s+=`${this.line}:${this.column}`),s.length>0&&(s+=": "),new Error(s+t)}fail(t){const e=this.makeError(t),s=this.errorHandler;if(void 0===s)throw e;return s(e),this}write(t){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let e=!1;null===t?(e=!0,t=""):"object"==typeof t&&(t=t.toString()),void 0!==this.carriedFromPrevious&&(t=`${this.carriedFromPrevious}${t}`,this.carriedFromPrevious=void 0);let s=t.length;const i=t.charCodeAt(s-1);!e&&(13===i||i>=55296&&i<=56319)&&(this.carriedFromPrevious=t[s-1],s--,t=t.slice(0,s));const{stateTable:r}=this;for(this.chunk=t,this.i=0;this.i<s;)r[this.state].call(this);return this.chunkPosition+=s,e?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return S;const s=t.charCodeAt(e);if(this.column++,s<55296){if(s>=32||9===s)return s;switch(s){case w:return this.line++,this.column=0,this.positionAtNewLine=this.position,w;case 13:return t.charCodeAt(e+1)===w&&(this.i=e+2),this.line++,this.column=0,this.positionAtNewLine=this.position,C;default:return this.fail("disallowed character."),s}}if(s>56319)return s>=57344&&s<=65533||this.fail("disallowed character."),s;const i=65536+1024*(s-55296)+(t.charCodeAt(e+1)-56320);return this.i=e+2,i>1114111&&this.fail("disallowed character."),i}getCode11(){const{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return S;const s=t.charCodeAt(e);if(this.column++,s<55296){if(s>31&&s<127||s>159&&8232!==s||9===s)return s;switch(s){case w:return this.line++,this.column=0,this.positionAtNewLine=this.position,w;case 13:{const s=t.charCodeAt(e+1);s!==w&&133!==s||(this.i=e+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,C;default:return this.fail("disallowed character."),s}}if(s>56319)return s>=57344&&s<=65533||this.fail("disallowed character."),s;const i=65536+1024*(s-55296)+(t.charCodeAt(e+1)-56320);return this.i=e+2,i>1114111&&this.fail("disallowed character."),i}getCodeNorm(){const t=this.getCode();return t===C?w:t}unget(){this.i=this.prevI,this.column--}captureTo(t){let{i:e}=this;const{chunk:s}=this;for(;;){const i=this.getCode(),r=i===C,n=r?w:i;if(n===S||t.includes(n))return this.text+=s.slice(e,this.prevI),n;r&&(this.text+=`${s.slice(e,this.prevI)}\n`,e=this.i)}}captureToChar(t){let{i:e}=this;const{chunk:s}=this;for(;;){let i=this.getCode();switch(i){case C:this.text+=`${s.slice(e,this.prevI)}\n`,e=this.i,i=w;break;case S:return this.text+=s.slice(e),!1}if(i===t)return this.text+=s.slice(e,this.prevI),!0}}captureNameChars(){const{chunk:t,i:e}=this;for(;;){const s=this.getCode();if(s===S)return this.name+=t.slice(e),S;if(!c(s))return this.name+=t.slice(e,this.prevI),s===C?w:s}}skipSpaces(){for(;;){const t=this.getCodeNorm();if(t===S||!o(t))return t}}setXMLVersion(t){this.currentXMLVersion=t,"1.0"===t?(this.isChar=a,this.getCode=this.getCode10):(this.isChar=u,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const t=this.i,e=this.skipSpaces();switch(this.prevI!==t&&(this.xmlDeclPossible=!1),e){case A:if(this.state=15,0!==this.text.length)throw new Error("no-empty text at start");break;case S:break;default:this.unget(),this.state=E,this.xmlDeclPossible=!1}}sDoctype(){var t;const e=this.captureTo(k);switch(e){case v:null===(t=this.doctypeHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=E,this.doctype=!0;break;case S:break;default:this.text+=String.fromCodePoint(e),91===e?this.state=4:N(e)&&(this.state=3,this.q=e)}}sDoctypeQuote(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.q=null,this.state=2)}sDTD(){const t=this.captureTo(P);t!==S&&(this.text+=String.fromCodePoint(t),t===R?this.state=2:t===A?this.state=6:N(t)&&(this.state=5,this.q=t))}sDTDQuoted(){const t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.state=4,this.q=null)}sDTDOpenWaka(){const t=this.getCodeNorm();switch(this.text+=String.fromCodePoint(t),t){case 33:this.state=7,this.openWakaBang="";break;case y:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const t=String.fromCodePoint(this.getCodeNorm()),e=this.openWakaBang+=t;this.text+=t,"-"!==e&&(this.state="--"===e?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),this.state=45===t?10:8}sDTDCommentEnded(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===v?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(y)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const t=this.getCodeNorm();this.text+=String.fromCodePoint(t),t===v&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:t}=this;const{chunk:e}=this;t:for(;;)switch(this.getCode()){case C:this.entity+=`${e.slice(t,this.prevI)}\n`,t=this.i;break;case 59:{const{entityReturnState:s}=this,i=this.entity+e.slice(t,this.prevI);let r;this.state=s,""===i?(this.fail("empty entity name."),r="&;"):(r=this.parseEntity(i),this.entity=""),s===E&&void 0===this.textHandler||(this.text+=r);break t}case S:this.entity+=e.slice(t);break t}}sOpenWaka(){const t=this.getCode();if(h(t))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(t){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case y:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=E,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var t;const e=this.getCodeNorm();45===e?(this.state=19,null===(t=this.commentHandler)||void 0===t||t.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(e)}`,this.state=17)}sCommentEnded(){const t=this.getCodeNorm();t!==v?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(t)}`,this.state=17):this.state=E}sCData(){this.captureToChar(R)&&(this.state=21)}sCDataEnding(){const t=this.getCodeNorm();t===R?this.state=22:(this.text+=`]${String.fromCodePoint(t)}`,this.state=20)}sCDataEnding2(){var t;const e=this.getCodeNorm();switch(e){case v:null===(t=this.cdataHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=E;break;case R:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(e)}`,this.state=20}}sPIFirstChar(){const t=this.getCodeNorm();this.nameStartCheck(t)?(this.piTarget+=String.fromCodePoint(t),this.state=24):t===y||o(t)?(this.fail("processing instruction without a target."),this.state=t===y?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(t),this.state=24)}sPIRest(){const{chunk:t,i:e}=this;for(;;){const s=this.getCodeNorm();if(s===S)return void(this.piTarget+=t.slice(e));if(!this.nameCheck(s)){this.piTarget+=t.slice(e,this.prevI);const i=s===y;i||o(s)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=i?T:27):this.state=i?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(s));break}}}sPIBody(){if(0===this.text.length){const t=this.getCodeNorm();t===y?this.state=26:o(t)||(this.text=String.fromCodePoint(t))}else this.captureToChar(y)&&(this.state=26)}sPIEnding(){var t;const e=this.getCodeNorm();if(e===v){const{piTarget:e}=this;"xml"===e.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(t=this.piHandler)||void 0===t||t.call(this,{target:e,body:this.text}),this.piTarget=this.text="",this.state=E}else e===y?this.text+="?":(this.text+=`?${String.fromCodePoint(e)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const t=this.skipSpaces();t!==y?t!==S&&(this.state=28,this.name=String.fromCodePoint(t)):this.state=T}sXMLDeclName(){const t=this.captureTo(D);if(t===y)return this.state=T,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(o(t)||t===I){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=t===I?30:29}}sXMLDeclEq(){const t=this.getCodeNorm();if(t===y)return this.state=T,void this.fail("XML declaration is incomplete.");o(t)||(t!==I&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const t=this.getCodeNorm();if(t===y)return this.state=T,void this.fail("XML declaration is incomplete.");o(t)||(N(t)?this.q=t:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const t=this.captureTo([this.q,y]);if(t===y)return this.state=T,this.text="",void this.fail("XML declaration is incomplete.");if(t===S)return;const e=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const t=e;this.xmlDecl.version=t,/^1\.[0-9]+$/.test(t)?this.opt.forceXMLVersion||this.setXMLVersion(t):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(e)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=e;break;case"standalone":"yes"!==e&&"no"!==e&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=e}this.name="",this.state=32}sXMLDeclSeparator(){const t=this.getCodeNorm();t!==y?(o(t)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=T}sXMLDeclEnding(){var t;this.getCodeNorm()===v?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(t=this.xmldeclHandler)||void 0===t||t.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=E):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var t;const e=this.captureNameChars();if(e===S)return;const s=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=s.ns=Object.create(null)),null===(t=this.openTagStartHandler)||void 0===t||t.call(this,s),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),e){case v:this.openTag();break;case 47:this.state=35;break;default:o(e)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===v?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const t=this.skipSpaces();t!==S&&(h(t)?(this.unget(),this.state=37):t===v?this.openTag():47===t?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const t=this.captureNameChars();t===I?this.state=39:o(t)?this.state=38:t===v?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):t!==S&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const t=this.skipSpaces();switch(t){case S:return;case I:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",t===v?this.openTag():h(t)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const t=this.getCodeNorm();N(t)?(this.q=t,this.state=40):o(t)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:t,chunk:e}=this;let{i:s}=this;for(;;)switch(this.getCode()){case t:return this.pushAttrib(this.name,this.text+e.slice(s,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=e.slice(s,this.prevI),this.state=14,void(this.entityReturnState=40);case w:case C:case 9:this.text+=`${e.slice(s,this.prevI)} `,s=this.i;break;case A:return this.text+=e.slice(s,this.prevI),void this.fail("disallowed character.");case S:return void(this.text+=e.slice(s))}}sAttribValueClosed(){const t=this.getCodeNorm();o(t)?this.state=36:t===v?this.openTag():47===t?this.state=35:h(t)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const t=this.captureTo(H);switch(t){case 38:this.state=14,this.entityReturnState=42;break;case A:this.fail("disallowed character.");break;case S:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",t===v?this.openTag():this.state=36}}sCloseTag(){const t=this.captureNameChars();t===v?this.closeTag():o(t)?this.state=44:t!==S&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case v:this.closeTag();break;case S:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:t,forbiddenState:e}=this;const{chunk:s,textHandler:i}=this;t:for(;;)switch(this.getCode()){case A:if(this.state=15,void 0!==i){const{text:e}=this,r=s.slice(t,this.prevI);0!==e.length?(i(e+r),this.text=""):0!==r.length&&i(r)}e=0;break t;case 38:this.state=14,this.entityReturnState=E,void 0!==i&&(this.text+=s.slice(t,this.prevI)),e=0;break t;case R:switch(e){case 0:e=1;break;case 1:e=2;break;case 2:break;default:throw new Error("impossible state")}break;case v:2===e&&this.fail('the string "]]>" is disallowed in char data.'),e=0;break;case C:void 0!==i&&(this.text+=`${s.slice(t,this.prevI)}\n`),t=this.i,e=0;break;case S:void 0!==i&&(this.text+=s.slice(t));break t;default:e=0}this.forbiddenState=e}handleTextOutsideRoot(){let{i:t}=this;const{chunk:e,textHandler:s}=this;let i=!1;t:for(;;){const r=this.getCode();switch(r){case A:if(this.state=15,void 0!==s){const{text:i}=this,r=e.slice(t,this.prevI);0!==i.length?(s(i+r),this.text=""):0!==r.length&&s(r)}break t;case 38:this.state=14,this.entityReturnState=E,void 0!==s&&(this.text+=e.slice(t,this.prevI)),i=!0;break t;case C:void 0!==s&&(this.text+=`${e.slice(t,this.prevI)}\n`),t=this.i;break;case S:void 0!==s&&(this.text+=e.slice(t));break t;default:o(r)||(i=!0)}}i&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(t,e){var s;const{prefix:i,local:r}=this.qname(t),n={name:t,prefix:i,local:r,value:e};if(this.attribList.push(n),null===(s=this.attributeHandler)||void 0===s||s.call(this,n),"xmlns"===i){const t=e.trim();"1.0"===this.currentXMLVersion&&""===t&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[r]=t,M(this,r,t)}else if("xmlns"===t){const t=e.trim();this.topNS[""]=t,M(this,"",t)}}pushAttribPlain(t,e){var s;const i={name:t,value:e};this.attribList.push(i),null===(s=this.attributeHandler)||void 0===s||s.call(this,i)}end(){var t,e;this.sawRoot||this.fail("document must contain a root element.");const{tags:s}=this;for(;s.length>0;){const t=s.pop();this.fail(`unclosed tag: ${t.name}`)}0!==this.state&&this.state!==E&&this.fail("unexpected end.");const{text:i}=this;return 0!==i.length&&(null===(t=this.textHandler)||void 0===t||t.call(this,i),this.text=""),this._closed=!0,null===(e=this.endHandler)||void 0===e||e.call(this),this._init(),this}resolve(t){var e,s;let i=this.topNS[t];if(void 0!==i)return i;const{tags:r}=this;for(let e=r.length-1;e>=0;e--)if(i=r[e].ns[t],void 0!==i)return i;return i=this.ns[t],void 0!==i?i:null===(s=(e=this.opt).resolvePrefix)||void 0===s?void 0:s.call(e,t)}qname(t){const e=t.indexOf(":");if(-1===e)return{prefix:"",local:t};const s=t.slice(e+1),i=t.slice(0,e);return(""===i||""===s||s.includes(":"))&&this.fail(`malformed name: ${t}.`),{prefix:i,local:s}}processAttribsNS(){var t;const{attribList:e}=this,s=this.tag;{const{prefix:e,local:i}=this.qname(s.name);s.prefix=e,s.local=i;const r=s.uri=null!==(t=this.resolve(e))&&void 0!==t?t:"";""!==e&&("xmlns"===e&&this.fail('tags may not have "xmlns" as prefix.'),""===r&&(this.fail(`unbound namespace prefix: ${JSON.stringify(e)}.`),s.uri=e))}if(0===e.length)return;const{attributes:i}=s,r=new Set;for(const t of e){const{name:e,prefix:s,local:n}=t;let o,a;""===s?(o="xmlns"===e?x:"",a=e):(o=this.resolve(s),void 0===o&&(this.fail(`unbound namespace prefix: ${JSON.stringify(s)}.`),o=s),a=`{${o}}${n}`),r.has(a)&&this.fail(`duplicate attribute: ${a}.`),r.add(a),t.uri=o,i[e]=t}this.attribList=[]}processAttribsPlain(){const{attribList:t}=this,e=this.tag.attributes;for(const{name:s,value:i}of t)void 0!==e[s]&&this.fail(`duplicate attribute: ${s}.`),e[s]=i;this.attribList=[]}openTag(){var t;this.processAttribs();const{tags:e}=this,s=this.tag;s.isSelfClosing=!1,null===(t=this.openTagHandler)||void 0===t||t.call(this,s),e.push(s),this.state=E,this.name=""}openSelfClosingTag(){var t,e,s;this.processAttribs();const{tags:i}=this,r=this.tag;r.isSelfClosing=!0,null===(t=this.openTagHandler)||void 0===t||t.call(this,r),null===(e=this.closeTagHandler)||void 0===e||e.call(this,r),null===(this.tag=null!==(s=i[i.length-1])&&void 0!==s?s:null)&&(this.closedRoot=!0),this.state=E,this.name=""}closeTag(){const{tags:t,name:e}=this;if(this.state=E,this.name="",""===e)return this.fail("weird empty close tag."),void(this.text+="</>");const s=this.closeTagHandler;let i=t.length;for(;i-- >0;){const i=this.tag=t.pop();if(this.topNS=i.ns,null==s||s(i),i.name===e)break;this.fail("unexpected close tag.")}0===i?this.closedRoot=!0:i<0&&(this.fail(`unmatched closing tag: ${e}.`),this.text+=`</${e}>`)}parseEntity(t){if("#"!==t[0]){const e=this.ENTITIES[t];return void 0!==e?e:(this.fail(this.isName(t)?"undefined entity.":"disallowed character in entity name."),`&${t};`)}let e=NaN;return"x"===t[1]&&/^#x[0-9a-f]+$/i.test(t)?e=parseInt(t.slice(2),16):/^#[0-9]+$/.test(t)&&(e=parseInt(t.slice(1),10)),this.isChar(e)?String.fromCodePoint(e):(this.fail("malformed character entity."),`&${t};`)}}},42249:(t,e,s)=>{const i=s(71846),r=s(37136),n=s(86777),o=s(22122);t.exports=class{constructor(t){this._reader=t,this._skipBytes=0}read(){return Promise.resolve().then((()=>this._readHeader())).then((()=>this._readMSAT())).then((()=>this._readSAT())).then((()=>this._readSSAT())).then((()=>this._readDirectoryTree())).then((()=>{if(0!=this._skipBytes)return this._readCustomHeader()})).then((()=>this))}_readCustomHeader(){const t=Buffer.alloc(this._skipBytes);return this._reader.read(t,0,this._skipBytes,0).then((t=>{this._customHeaderCallback(t)}))}_readHeader(){const t=Buffer.alloc(512);return this._reader.read(t,0,512,0+this._skipBytes).then((t=>{if(!(this._header=new i).load(t))throw new Error("Not a valid compound document")}))}_readMSAT(){const t=this._header;if(this._MSAT=t.partialMSAT.slice(0),this._MSAT.length=t.SATSize,t.SATSize<=109||0==t.MSATSize)return Promise.resolve();const e=(s,i,r)=>s>=t.MSATSize?Promise.resolve():this._readSector(r).then((n=>{let o;for(o=0;o<t.secSize-4&&!(i>=t.SATSize);o+=4)this._MSAT[i]=n.readInt32LE(o),i++;return r=n.readInt32LE(t.secSize-4),e(s+1,i,r)}));return e(0,109,t.MSATSecId)}_readSector(t){return this._readSectors([t])}_readSectors(t){const e=this._header,s=Buffer.alloc(t.length*e.secSize),i=r=>{if(r>=t.length)return Promise.resolve(s);const n=r*e.secSize,o=this._getFileOffsetForSec(t[r]);return this._reader.read(s,n,e.secSize,o).then((()=>i(r+1)))};return i(0)}_readShortSector(t){return this._readShortSectors([t])}_readShortSectors(t){const e=this._header,s=Buffer.alloc(t.length*e.shortSecSize),i=r=>{if(r>=t.length)return Promise.resolve(s);const n=r*e.shortSecSize,o=this._getFileOffsetForShortSec(t[r]);return this._reader.read(s,n,e.shortSecSize,o).then((()=>i(r+1)))};return i(0)}_readSAT(){return this._SAT=new r(this),this._SAT.load(this._MSAT)}_readSSAT(){const t=this._header,e=this._SAT.getSecIdChain(t.SSATSecId);return e.length!=t.SSATSize?Promise.reject(new Error("Invalid Short Sector Allocation Table")):(this._SSAT=new r(this),this._SSAT.load(e))}_readDirectoryTree(){const t=this._header;this._directoryTree=new n(this);const e=this._SAT.getSecIdChain(t.dirSecId);return this._directoryTree.load(e).then((()=>{const t=this._directoryTree.root;this._rootStorage=new o(this,t),this._shortStreamSecIds=this._SAT.getSecIdChain(t.secId)}))}_getFileOffsetForSec(t){const e=this._header.secSize;return this._skipBytes+(t+1)*e}_getFileOffsetForShortSec(t){const e=t*this._header.shortSecSize,s=this._header.secSize,i=Math.floor(e/s),r=e%s,n=this._shortStreamSecIds[i];return this._getFileOffsetForSec(n)+r}storage(t){return this._rootStorage.storage(t)}stream(t){return this._rootStorage.stream(t)}}},44762:(t,e,s)=>{const i=s(79896);class r{constructor(t){this._filename=t}open(){return new Promise(((t,e)=>{i.open(this._filename,"r",438,((s,i)=>{if(s)return e(s);this._fd=i,t()}))}))}close(){return new Promise(((t,e)=>{this._fd?i.close(this._fd,(s=>{if(s)return e(s);delete this._fd,t()})):t()}))}read(t,e,s,r){return new Promise(((n,o)=>{if(!this._fd)return o(new Error("file not open"));i.read(this._fd,t,e,s,r,((t,e,s)=>{if(t)return o(t);n(s)}))}))}fd(){return this._fd}static isFileReader(t){return t instanceof r}}t.exports=r},48066:(t,e,s)=>{const{Buffer:i}=s(20181),r=s(32484),n=s(31682),o=s(12082),a=s(44762);t.exports=class{constructor(){}extract(t){let e=null;i.isBuffer(t)?e=new o(t):"string"==typeof t&&(e=new a(t));const s=i.alloc(512);return e.open().then((()=>e.read(s,0,512,0))).then((t=>{let s=null;if(53455===t.readUInt16BE(0))s=r;else if(20555===t.readUInt16BE(0)){const e=t.readUInt16BE(2);772!==e&&1286!==e&&1800!==e||(s=n)}if(!s)throw new Error("Unable to read this type of file");return(new s).extract(e)})).finally((()=>e.close()))}}},71846:t=>{const e=Buffer.from("D0CF11E0A1B11AE1","hex");t.exports=class{constructor(){}load(t){for(let s=0;s<e.length;s++)if(e[s]!=t[s])return!1;this.secSize=1<<t.readInt16LE(30),this.shortSecSize=1<<t.readInt16LE(32),this.SATSize=t.readInt32LE(44),this.dirSecId=t.readInt32LE(48),this.shortStreamMax=t.readInt32LE(56),this.SSATSecId=t.readInt32LE(60),this.SSATSize=t.readInt32LE(64),this.MSATSecId=t.readInt32LE(68),this.MSATSize=t.readInt32LE(72),this.partialMSAT=new Array(109);for(let e=0;e<109;e++)this.partialMSAT[e]=t.readInt32LE(76+4*e);return!0}}},82327:t=>{const e=[];e[2]="\0",e[5]="\0",e[7]="\t",e[8]="\0",e[10]="\n",e[11]="\n",e[12]="\n",e[13]="\n",e[30]="‑";const s=[];s[130]="‚",s[131]="ƒ",s[132]="„",s[133]="…",s[134]="†",s[135]="‡",s[136]="ˆ",s[137]="‰",s[138]="Š",s[139]="‹",s[140]="Œ",s[142]="Ž",s[145]="‘",s[146]="’",s[147]="“",s[148]="”",s[149]="•",s[150]="–",s[151]="—",s[152]="˜",s[153]="™",s[154]="š",s[155]="›",s[156]="œ",s[158]="ž",s[159]="Ÿ",t.exports.binaryToUnicode=t=>t.replace(/([\x80-\x9f])/g,(t=>s[t.charCodeAt(0)])),t.exports.clean=t=>{t=t.replace(/([\x02\x05\x07\x08\x0a\x0b\x0c\x0d\x1f])/g,(t=>e[t.charCodeAt(0)]));let s=!0;for(;s;)s=!1,t=t.replace(/(?:\x13[^\x13\x14\x15]*\x14?([^\x13\x14\x15]*)\x15)/g,((t,e)=>(s=!0,e)));return t.replace(/[\x00-\x07]/g,"")};const i=[];i[8194]=" ",i[8195]=" ",i[8210]="-",i[8211]="-",i[8212]="-",i[8216]="'",i[8217]="'",i[8220]='"',i[8221]='"',t.exports.filter=t=>t.replace(/[\u2002\u2003\u2012\u2013\u2014\u2018\u2019\u201c\u201d]/g,(t=>i[t.charCodeAt(0)]))},84797:(t,e)=>{"use strict";function s(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="-퟿-�𐀀-􏿿",e.RESTRICTED_CHAR="-\b\v\f---",e.S=" \t\r\n",e.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.CHAR_RE=new RegExp("^["+e.CHAR+"]$","u"),e.RESTRICTED_CHAR_RE=new RegExp("^["+e.RESTRICTED_CHAR+"]$","u"),e.S_RE=new RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=new RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=new RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=new RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=new RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(t){return t>=1&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isRestrictedChar=function(t){return t>=1&&t<=8||11===t||12===t||t>=14&&t<=31||t>=127&&t<=132||t>=134&&t<=159},e.isCharAndNotRestricted=function(t){return 9===t||10===t||13===t||t>31&&t<127||133===t||t>159&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isS=function(t){return 32===t||10===t||13===t||9===t},e.isNameStartChar=s,e.isNameChar=function(t){return s(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},86777:t=>{t.exports=class{constructor(t){this._doc=t}load(t){return this._doc._readSectors(t).then((t=>{const e=t.length/128;this._entries=new Array(e);for(let s=0;s<e;s++){const e=128*s,i=Math.max(t.readInt16LE(64+e)-1,0),r={};r.name=t.toString("utf16le",0+e,i+e),r.type=t.readInt8(66+e),r.nodeColor=t.readInt8(67+e),r.left=t.readInt32LE(68+e),r.right=t.readInt32LE(72+e),r.storageDirId=t.readInt32LE(76+e),r.secId=t.readInt32LE(116+e),r.size=t.readInt32LE(120+e),this._entries[s]=r}this.root=this._entries.find((t=>5===t.type)),this._buildHierarchy(this.root)}))}_buildHierarchy(t){const e=this._getChildIds(t);t.storages={},t.streams={};for(const s of e){const e=this._entries[s],i=e.name;1===e.type&&(t.storages[i]=e),2===e.type&&(t.streams[i]=e)}for(const e in t.storages)this._buildHierarchy(t.storages[e])}_getChildIds(t){const e=[],s=t=>{-1!==t.left&&(e.push(t.left),s(this._entries[t.left])),-1!==t.right&&(e.push(t.right),s(this._entries[t.right]))};if(t.storageDirId>-1){e.push(t.storageDirId);const i=this._entries[t.storageDirId];s(i)}return e}}}};
//# sourceMappingURL=66.js.map